{% extends "base.html" %}

{% block content %}
<div class="disease-container">
    <h2>Plant Disease Detection</h2>
    
    <form method="POST" enctype="multipart/form-data">
        <div class="form-group">
            <label for="image">Upload Plant Image:</label>
            <input type="file" id="image" name="image" accept="image/*" required>
        </div>
        <button type="submit">Detect Disease</button>
    </form>
    
    {% if result %}
        <div class="result">
            <h3>Detection Result:</h3>
            <div class="image-preview">
                <img src="#" id="preview" alt="Uploaded plant image">
                <div class="diagnosis">
                    <p><strong>Diagnosis:</strong> {{ result.class }}</p>
                    <p><strong>Confidence:</strong> {{ result.confidence }}%</p>
                </div>
            </div>
        </div>
        
        <script>
            // Display the uploaded image
            const fileInput = document.getElementById('image');
            const preview = document.getElementById('preview');
            
            fileInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.src = e.target.result;
                    }
                    reader.readAsDataURL(file);
                }
            });
            
            // Set the preview image from the uploaded file
            preview.src = "data:image/jpeg;base64," + "{{ result.image }}";
        </script>
    {% endif %}
</div>
{% endblock %}